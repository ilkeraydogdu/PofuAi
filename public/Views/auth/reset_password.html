{% extends "layouts/auth_layout.html" %}

{% block title %}PofuAi | Şifre Sıfırla{% endblock %}

{% block auth_bg_color %}bg-grd-warning{% endblock %}
{% block auth_image %}/static/assets/images/auth/reset-password1.png{% endblock %}

{% block auth_form %}
<img src="/static/assets/images/logo1.png" class="mb-4" width="145" alt="">
<h4 class="fw-bold">{{ messages.form_title }}</h4>
<p class="mb-0">{{ messages.form_subtitle }}</p>

<!-- Yeni kayıt olan kullanıcılar için bilgilendirme mesajı -->
{% if request.args.get('new_registration') == 'true' or request.args.get('new_registration') == '1' %}
<div class="alert alert-info border-0 bg-info alert-dismissible fade show py-2 mt-3">
    <div class="d-flex align-items-center">
        <div class="font-35 text-white"><i class="bi bi-info-circle-fill"></i></div>
        <div class="ms-3">
            <h6 class="mb-0 text-white">Kaydınız Başarıyla Tamamlandı!</h6>
            <div class="text-white">Güvenliğiniz için lütfen kalıcı şifrenizi oluşturun. E-posta adresinize gönderilen geçici şifre ile giriş yapabilirsiniz.</div>
        </div>
    </div>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endif %}

<div class="form-body mt-4">
    <form class="row g-3" method="POST" action="/auth/reset-password">
        <input type="hidden" name="token" value="{{ token }}">
        <div class="col-12">
            <label for="inputPassword" class="form-label">Yeni Şifre</label>
            <div class="input-group" id="show_hide_password">
                <input type="password" class="form-control border-end-0" id="inputPassword" name="password" placeholder="Yeni şifrenizi girin" required>
                <a href="javascript:;" class="input-group-text bg-transparent"><i class="bi bi-eye-slash-fill"></i></a>
            </div>
        </div>
        <div class="col-12">
            <label for="inputConfirmPassword" class="form-label">Şifre Tekrarı</label>
            <div class="input-group" id="show_hide_password_confirm">
                <input type="password" class="form-control border-end-0" id="inputConfirmPassword" name="password_confirm" placeholder="Yeni şifrenizi tekrar girin" required>
                <a href="javascript:;" class="input-group-text bg-transparent"><i class="bi bi-eye-slash-fill"></i></a>
            </div>
        </div>
        <div class="col-12">
            <div class="d-grid">
                <button type="submit" class="btn btn-grd-warning">{{ messages.submit_button }}</button>
            </div>
        </div>
        <div class="col-12 text-center">
            <p class="mb-0"><a href="/auth/login" class="fw-bold text-warning">Giriş sayfasına dön</a></p>
        </div>
    </form>
</div>

{% block extra_js %}
<script>
    // Şifre göster/gizle fonksiyonları
    document.addEventListener('DOMContentLoaded', function() {
        const togglePassword = document.querySelector('#show_hide_password a');
        const toggleConfirmPassword = document.querySelector('#show_hide_password_confirm a');
        
        togglePassword.addEventListener('click', function() {
            const password = document.querySelector('#inputPassword');
            const icon = this.querySelector('i');
            
            if (password.type === 'password') {
                password.type = 'text';
                icon.classList.remove('bi-eye-slash-fill');
                icon.classList.add('bi-eye-fill');
            } else {
                password.type = 'password';
                icon.classList.remove('bi-eye-fill');
                icon.classList.add('bi-eye-slash-fill');
            }
        });
        
        toggleConfirmPassword.addEventListener('click', function() {
            const confirmPassword = document.querySelector('#inputConfirmPassword');
            const icon = this.querySelector('i');
            
            if (confirmPassword.type === 'password') {
                confirmPassword.type = 'text';
                icon.classList.remove('bi-eye-slash-fill');
                icon.classList.add('bi-eye-fill');
            } else {
                confirmPassword.type = 'password';
                icon.classList.remove('bi-eye-fill');
                icon.classList.add('bi-eye-slash-fill');
            }
        });
    });
</script>
{% endblock %}
{% endblock %} 