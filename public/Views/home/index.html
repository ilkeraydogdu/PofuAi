{% extends "layouts/base_layout.html" %}
{% import "components/_macros.html" as components %}

{% block title %}{{ title|default('PofuAi | Dashboard') }}{% endblock %}

{% block content %}
<div class="page-content-wrapper">
    <div class="page-content">
        <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
            <div class="breadcrumb-title pe-3">Dashboard</div>
            <div class="ps-3">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0 p-0">
                        <li class="breadcrumb-item"><a href="/"><i class="bx bx-home-alt"></i></a></li>
                        <li class="breadcrumb-item active" aria-current="page">Dashboard</li>
                    </ol>
                </nav>
            </div>
        </div>
        
        <!-- İstatistik kartları -->
        {% if stats and page and page.page_config.show_stats %}
        <div class="row row-cols-1 row-cols-md-2 row-cols-xl-4">
            <div class="col">
                <div class="card radius-10">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div>
                                <p class="mb-0 text-secondary">Toplam Kullanıcı</p>
                                <h4 class="my-1">{{ stats.total_users }}</h4>
                            </div>
                            <div class="widget-icon-large bg-gradient-primary text-white ms-auto">
                                <i class="bi bi-people"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card radius-10">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div>
                                <p class="mb-0 text-secondary">Aktif Kullanıcı</p>
                                <h4 class="my-1">{{ stats.active_users }}</h4>
                            </div>
                            <div class="widget-icon-large bg-gradient-success text-white ms-auto">
                                <i class="bi bi-person-check"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card radius-10">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div>
                                <p class="mb-0 text-secondary">Toplam İçerik</p>
                                <h4 class="my-1">{{ stats.total_posts }}</h4>
                            </div>
                            <div class="widget-icon-large bg-gradient-info text-white ms-auto">
                                <i class="bi bi-file-earmark-text"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="card radius-10">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div>
                                <p class="mb-0 text-secondary">Yayınlanan İçerik</p>
                                <h4 class="my-1">{{ stats.published_posts }}</h4>
                            </div>
                            <div class="widget-icon-large bg-gradient-warning text-white ms-auto">
                                <i class="bi bi-file-earmark-check"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        
        <!-- Grafikler -->
        {% if page and page.page_config.show_graphs %}
        <div class="row">
            <div class="col-12 col-lg-8">
                {{ components.card(
                    title=page.content_blocks.stats_title|default("Ziyaretçi İstatistikleri"),
                    content='<div id="chart1"></div>
                    <script>
                        document.addEventListener("DOMContentLoaded", function() {
                            var options = {
                                series: [{
                                    name: "Ziyaretçiler",
                                    data: [89, 78, 95, 76, 85, 90, 74]
                                }],
                                chart: {
                                    height: 350,
                                    type: "area",
                                    toolbar: {
                                        show: false
                                    }
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                stroke: {
                                    curve: "smooth"
                                },
                                xaxis: {
                                    categories: ["Pzt", "Sal", "Çar", "Per", "Cum", "Cts", "Paz"]
                                },
                                colors: ["#3461ff"]
                            };
                            var chart = new ApexCharts(document.querySelector("#chart1"), options);
                            chart.render();
                        });
                    </script>'
                ) }}
            </div>
            <div class="col-12 col-lg-4">
                {{ components.card(
                    title="İçerik Dağılımı",
                    content='<div id="chart2"></div>
                    <script>
                        document.addEventListener("DOMContentLoaded", function() {
                            var options = {
                                series: [44, 55, 13, 43],
                                chart: {
                                    width: "100%",
                                    type: "pie",
                                },
                                labels: ["Makale", "Video", "Podcast", "Galeri"],
                                colors: ["#3461ff", "#14abef", "#ffc107", "#ff6632"],
                                responsive: [{
                                    breakpoint: 480,
                                    options: {
                                        chart: {
                                            width: 200
                                        },
                                        legend: {
                                            position: "bottom"
                                        }
                                    }
                                }]
                            };
                            var chart = new ApexCharts(document.querySelector("#chart2"), options);
                            chart.render();
                        });
                    </script>'
                ) }}
            </div>
        </div>
        {% endif %}
        
        <!-- Son aktiviteler -->
        {% if recent_activities and page and page.page_config.show_recent_activities %}
        <div class="row">
            <div class="col-12">
                {{ components.card(
                    title=page.content_blocks.recent_activities_title|default("Son Aktiviteler"),
                    content='<div class="timeline-vertical">
                        {% for activity in recent_activities %}
                        <div class="timeline-item">
                            <div class="timeline-icon bg-primary">
                                <i class="bi bi-file-earmark-text text-white"></i>
                            </div>
                            <div class="timeline-content">
                                <h6 class="mb-0">{{ activity.title }}</h6>
                                <p class="mb-0">{{ activity.user }} tarafından {{ activity.time }}</p>
                            </div>
                        </div>
                        {% endfor %}
                    </div>'
                ) }}
            </div>
        </div>
        {% endif %}
        
        <!-- Popüler içerikler -->
        {% if popular_content and page and page.page_config.show_popular_content %}
        <div class="row">
            <div class="col-12">
                {{ components.card(
                    title=page.content_blocks.popular_content_title|default("Popüler İçerikler"),
                    content='
                        {% for content in popular_content %}
                        <div class="card border shadow-none radius-10 mb-3">
                            <div class="card-body">
                                <div class="d-flex align-items-center">
                                    <div class="product-img">
                                        <img src="/static/assets/images/gallery/01.png" class="p-1" alt="">
                                    </div>
                                    <div class="ms-3">
                                        <h6 class="mb-0">{{ content.title }}</h6>
                                        <p class="mb-0 text-secondary">{{ content.excerpt }}</p>
                                    </div>
                                    <div class="ms-auto">
                                        <div class="d-flex align-items-center">
                                            <div class="me-2">
                                                <span class="badge bg-light text-dark"><i class="bi bi-eye me-1"></i>{{ content.views }}</span>
                                            </div>
                                            <div>
                                                <span class="badge bg-light text-dark"><i class="bi bi-heart me-1"></i>{{ content.likes }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    '
                ) }}
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/assets/plugins/apexchart/apexcharts.min.js"></script>
{% endblock %} 